<?xml version="1.0" encoding="utf-8"?>
<manifest
   xmlns:android="http://schemas.android.com/apk/res/android"
	android:versionName="1.0"
	package="dev.drsoran.moloko"
	android:versionCode="001">

	<application
	   android:icon="@drawable/icon"
	   android:label="@string/app_name"
	   android:theme="@style/Theme.Moloko"
	   android:debuggable="true">
	   
	   <!-- Declare the default searchable Activity for the whole app -->
      <meta-data
         android:name="android.app.default_searchable"
         android:value=".activities.TaskSearchResultActivity" />
		
      <!-- Content Provider -->          
      <provider
         android:name=".content.RtmProvider"
         android:authorities="dev.drsoran.provider.Rtm"
         android:syncable="true" />
         
      <provider
         android:name=".search.TasksSearchRecentSuggestionsProvider"
         android:authorities="dev.drsoran.moloko.search.TasksSearchRecentSuggestionsProvider" />

      <!-- Activities -->
	   <activity
         android:label="@string/app_name"
		   android:name=".activities.TasksListActivity">
		   <intent-filter>
            <action
				  android:name="android.intent.action.MAIN" />
				<category
				  android:name="android.intent.category.LAUNCHER" />
			</intent-filter>
			<intent-filter>
			   <!-- Show a list of tasks -->
            <action
               android:name="android.intent.action.VIEW" />
            <category
               android:name="android.intent.category.DEFAULT" />
            <data
               android:mimeType="vnd.android.cursor.dir/vnd.rtm.task" />
         </intent-filter>
         <intent-filter>
            <!-- Handle search queries -->
            <action
               android:name="android.intent.action.SEARCH" />
         </intent-filter>
      </activity>
      
      <activity
         android:label="@string/app_tasklists"
         android:name=".activities.TaskListsActivity">
         <intent-filter>
            <!-- Show an overview of task lists -->
            <action
               android:name="android.intent.action.VIEW" />
            <category
               android:name="android.intent.category.DEFAULT" />
            <data
               android:mimeType="vnd.android.cursor.dir/vnd.rtm.list_overview" />
         </intent-filter>         
         <intent-filter>
            <!-- Show all lists of tasks and let the user
                 pick one list. Returns the URI back.-->
            <action
               android:name="android.intent.action.PICK" />           
            <category
               android:name="android.intent.category.DEFAULT" />
            <data
               android:mimeType="vnd.android.cursor.dir/vnd.rtm.list" />
         </intent-filter>
      </activity>
      
      <activity
         android:label="@string/app_name"
         android:name=".activities.TaskSearchResultActivity"
         android:launchMode="singleTop"> <!-- SingleTop due to searchable -->
         <intent-filter>
            <!-- Handle search queries -->
            <action
               android:name="android.intent.action.SEARCH" />
         </intent-filter>
         <meta-data
            android:name="android.app.searchable"
            android:resource="@xml/searchable"/>
      </activity>
      
      <activity
         android:label="@string/app_task"
         android:name=".activities.TaskActivity"
         android:theme="@style/Theme.Moloko.Task">
         <intent-filter>
            <!-- Show a single task -->
            <action
               android:name="android.intent.action.VIEW" />
            <category
               android:name="android.intent.category.DEFAULT" />
            <data
               android:mimeType="vnd.android.cursor.item/vnd.rtm.task" />
         </intent-filter>
      </activity>
      
      <activity
         android:label="@string/app_note"
         android:name=".activities.NoteActivity"
         android:theme="@style/Theme.Moloko.Note">
         <intent-filter>
            <!-- Show a single note -->
            <!-- Show all notes of a task -->
            <action
               android:name="android.intent.action.VIEW" />
            <category
               android:name="android.intent.category.DEFAULT" />
            <data
               android:mimeType="vnd.android.cursor.item/vnd.rtm.note" />
            <data
               android:mimeType="vnd.android.cursor.dir/vnd.rtm.note" />
         </intent-filter>
      </activity>
      
      <!--  Deactivated
      <activity
		    android:label="@string/app_preferences"
		    android:name=".auth.prefs.AccountPreferencesActivity"
		    android:excludeFromRecents="true">
      </activity>
      
       -->
                 
      <activity
          android:name=".auth.AuthenticatorActivity"
          android:label="@string/rtm_full"
          android:excludeFromRecents="true"/>
          
      <activity
          android:name=".auth.RtmWebLoginActivity"
          android:label="@string/rtm_full"
          android:excludeFromRecents="true"/>
          
      <activity
          android:name=".activities.RtmSmartFilterTestActivity"
          android:label="Test RTM smart filter"
          android:excludeFromRecents="true"/>
		
		<!-- Services -->
		
      <service
         android:name=".auth.AuthenticationService"
         android:exported="true">
         <intent-filter>
            <action
               android:name="android.accounts.AccountAuthenticator" />
         </intent-filter>
         <meta-data
            android:name="android.accounts.AccountAuthenticator"
            android:resource="@xml/authenticator" />
      </service>
      
      <service
         android:name=".service.sync.SyncService"
         android:exported="true">
         <intent-filter>
            <action
               android:name="android.content.SyncAdapter" />
         </intent-filter>
         <meta-data
             android:name="android.content.SyncAdapter"
             android:resource="@xml/syncadapter" />
      </service>      
   </application>

   <uses-permission
        android:name="android.permission.ACCESS_NETWORK_STATE"/>
	<uses-permission
	     android:name="android.permission.INTERNET"/>
   <uses-permission
        android:name="android.permission.GET_ACCOUNTS" />        
   <uses-permission
       android:name="android.permission.USE_CREDENTIALS" />   
   <uses-permission
       android:name="android.permission.MANAGE_ACCOUNTS" />
   <uses-permission
       android:name="android.permission.AUTHENTICATE_ACCOUNTS" />
   <uses-permission
       android:name="android.permission.WRITE_SETTINGS" />
   <uses-permission
       android:name="android.permission.READ_SYNC_STATS" />
   <uses-permission
       android:name="android.permission.READ_SYNC_SETTINGS" />
   <uses-permission
       android:name="android.permission.WRITE_SYNC_SETTINGS" />
</manifest> 